# 类型拓展与自定义模块

## 拓展全局对象

```ts
export {} //处理为模块

declare global {
  interface Window {
    myProperty: string
  }
}
```

```ts
declare global {
  interface ImportMetaEnv {
    MY_ENV: string
  }
}
// import.meta.env.MY_ENV // string
declare global {
  namespace NodeJS {
    interface ProcessEnv {
      MY_ENV: string
    }
  }
}
// process.env.MY_ENV // string
declare global {
  interface Window {
    MY_ENV: string
  }
}
// window.MY_ENV // string
```

## 拓展 nodejs 内部模块

```ts
declare module 'net' {
  interface Socket {
    macAddress?: string
    timeoutId?: NodeJS.Timeout
  }
}
```

## 处理资源文件

> copy from vite client.d.ts
> [vite 中处理资源文件的方式](../types-tools/asset.d.ts)
> 或者

```ts
declare module 'virtual:*' {
  const result: any
  export default result
}
// 使用
import 'virtual:windi-base.css'
import 'virtual:windi-components.css'
import 'virtual:windi-utilities.css'
```

## 为第三方模块添加类型定义

```ts
// declare ? 命名空间
// 定义函数
// 定义构造函数
```

Declaration Reference

Objects with Properties

```js
let myLib = {}
let result = myLib.makeGreeting('hello, world')
console.log('The computed greeting is:' + result)
let count = myLib.numberOfGreetings
```

```ts
declare namespace myLib {
  function makeGreeting(s: string): string
  let numberOfGreetings: number
}
```

Overloaded Functions

```ts
let x: Widget = getWidget(43)
let arr: Widget[] = getWidget('all of them')
```

```ts
declare function getWidget(n: number): Widget
declare function getWidget(s: string): Widget[]
```

Classes

```ts
const myGreeter = new Greeter('hello, world')
myGreeter.greeting = 'howdy'
myGreeter.showGreeting()
class SpecialGreeter extends Greeter {
  constructor() {
    super('Very special greetings')
  }
}
```

```ts
declare class Greeter {
  constructor(greeting: string)
  greeting: string
  showGreeting(): void
}
```

## 为 node 插件添加类型定义

```ts
declare module '<xxx>.node' {}
```

- 拓展全局对象

## 拓展全局对象

```ts
export {} //处理为模块

declare global {
  interface Window {
    myProperty: string
  }
}
```

## 拓展 nodejs 内部模块

```ts
declare module 'net' {
  interface Socket {
    macAddress?: string
    timeoutId?: NodeJS.Timeout
  }
}
```

## 处理资源文件

> copy from vite client.d.ts
> [vite 中处理资源文件的方式](../types-tools/asset.d.ts)
> 或者

```ts
declare module 'virtual:*' {
  const result: any
  export default result
}
// 使用
import 'virtual:windi-base.css'
import 'virtual:windi-components.css'
import 'virtual:windi-utilities.css'
```

## 为第三方模块添加类型定义

```ts
// declare ? 命名空间
// 定义函数
// 定义构造函数
```

Declaration Reference

Objects with Properties

```js
let myLib = {}
let result = myLib.makeGreeting('hello, world')
console.log('The computed greeting is:' + result)
let count = myLib.numberOfGreetings
```

```ts
declare namespace myLib {
  function makeGreeting(s: string): string
  let numberOfGreetings: number
}
```

Overloaded Functions

```ts
let x: Widget = getWidget(43)
let arr: Widget[] = getWidget('all of them')
```

```ts
declare function getWidget(n: number): Widget
declare function getWidget(s: string): Widget[]
```

Classes

```ts
const myGreeter = new Greeter('hello, world')
myGreeter.greeting = 'howdy'
myGreeter.showGreeting()
class SpecialGreeter extends Greeter {
  constructor() {
    super('Very special greetings')
  }
}
```

```ts
declare class Greeter {
  constructor(greeting: string)
  greeting: string
  showGreeting(): void
}
```

## 为 node 插件添加类型定义

```ts
declare module '<xxx>.node' {}
```

## resources

- https://www.typescriptlang.org/docs/handbook/declaration-files/library-structures.html
- https://www.typescriptlang.org/docs/handbook/declaration-files/by-example.html
